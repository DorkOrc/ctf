# run as victim, tag=attacker is player that did the tag
tag @s remove carrying
scoreboard players set @e[tag=attacker] captured 0
scoreboard players set @s place_timer 0
ride @e[tag=flag_mount, sort=nearest, limit=1] dismount
ride @e[tag=flag_mount, sort=nearest, limit=1] mount @e[tag=attacker, sort=nearest, limit=1]
tag @e[tag=attacker] add carrying
tag @e[tag=flag, sort=nearest, limit=1] add current_flag

execute if entity @e[tag=current_flag, nbt={Item:{id:"minecraft:orange_candle"}}] run tag @e[tag=attacker] add carrying_mesa
execute if entity @e[tag=current_flag, nbt={Item:{id:"minecraft:pink_candle"}}] run tag @e[tag=attacker] add carrying_cherry
execute if entity @e[tag=current_flag, nbt={Item:{id:"minecraft:yellow_candle"}}] run tag @e[tag=attacker] add carrying_desert
execute if entity @e[tag=current_flag, nbt={Item:{id:"minecraft:light_blue_candle"}}] run tag @e[tag=attacker] add carrying_ice
execute if entity @e[tag=current_flag, nbt={Item:{id:"minecraft:green_candle"}}] run tag @e[tag=attacker] add carrying_forest

tag @e remove current_flag


execute at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=mesa] run tellraw @a[tag=victim, sort=nearest, limit=1] [{"text":"[!]","color":"red"},{"text":" You were TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=cherry] run tellraw @a[tag=victim, sort=nearest, limit=1] [{"text":"[!]","color":"red"},{"text":" You were TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=desert] run tellraw @a[tag=victim, sort=nearest, limit=1] [{"text":"[!]","color":"red"},{"text":" You were TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=ice] run tellraw @a[tag=victim, sort=nearest, limit=1] [{"text":"[!]","color":"red"},{"text":" You were TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=forest] run tellraw @a[tag=victim, sort=nearest, limit=1] [{"text":"[!]","color":"red"},{"text":" You were TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]


execute if entity @s[team=mesa] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=mesa] run tellraw @a[tag=!victim] [[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=mesa] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=cherry] run tellraw @a[tag=!victim] [[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=mesa] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=desert] run tellraw @a[tag=!victim] [[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=mesa] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=ice] run tellraw @a[tag=!victim] [[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=mesa] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=forest] run tellraw @a[tag=!victim] [[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]

execute if entity @s[team=cherry] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=mesa] run tellraw @a[tag=!victim] [[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=cherry] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=cherry] run tellraw @a[tag=!victim] [[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=cherry] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=desert] run tellraw @a[tag=!victim] [[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=cherry] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=ice] run tellraw @a[tag=!victim] [[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=cherry] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=forest] run tellraw @a[tag=!victim] [[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]

execute if entity @s[team=desert] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=mesa] run tellraw @a[tag=!victim] [[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=desert] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=cherry] run tellraw @a[tag=!victim] [[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=desert] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=desert] run tellraw @a[tag=!victim] [[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=desert] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=ice] run tellraw @a[tag=!victim] [[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=desert] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=forest] run tellraw @a[tag=!victim] [[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]

execute if entity @s[team=ice] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=mesa] run tellraw @a[tag=!victim] [[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=ice] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=cherry] run tellraw @a[tag=!victim] [[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=ice] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=desert] run tellraw @a[tag=!victim] [[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=ice] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=ice] run tellraw @a[tag=!victim] [[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=ice] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=forest] run tellraw @a[tag=!victim] [[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]

execute if entity @s[team=forest] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=mesa] run tellraw @a[tag=!victim] [[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"mesa","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=forest] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=cherry] run tellraw @a[tag=!victim] [[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"cherry","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=forest] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=desert] run tellraw @a[tag=!victim] [[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"desert","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=forest] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=ice] run tellraw @a[tag=!victim] [[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"ice","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
execute if entity @s[team=forest] at @s as @a[tag=attacker, sort=nearest, limit=1] if entity @s[team=forest] run tellraw @a[tag=!victim] [[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=victim, limit=1, sort=nearest]"}],{"text":" was TAGGED, so the flag was transferred to ", "color": "white"},[{"nbt":"forest","storage":"colors","interpret":true},{"selector":"@a[tag=attacker, sort=nearest, limit=1]"}],{"text":"!","color": "white"}]
